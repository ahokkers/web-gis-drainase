<!DOCTYPE html>
<html>
<head>
    <title>WebGIS Drainase Jakarta</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        #map { height: 600px; width: 100%; }
        .info-popup { font-family: Arial; line-height: 1.4; }
    </style>
</head>
<body>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet-polylinedecorator@1.6.0/dist/leaflet.polylineDecorator.js"></script>
    
    <script src="data_saluranphb.js"></script>

    <script>
        var map = L.map('map').setView([-6.1993, 106.8203], 15);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        // --- LAYER 1: SALURAN PHB (Tersier) ---
        if (typeof dataTersier !== 'undefined') {
            var saluranLayer = L.geoJSON(dataTersier, {
                style: { color: "blue", weight: 6, opacity: 0.9 }
            }).addTo(map);
            map.fitBounds(saluranLayer.getBounds());
        }

        // --- LAYER 2: SALURAN MIKRO (Load dari GeoJSON hasil Mapshaper) ---
        fetch('saluran_mikro.geojson') // Nama file hasil export Mapshaper
            .then(response => response.json())
            .then(data => {
                L.geoJSON(data, {
                    style: { color: "cyan", weight: 3, opacity: 0.8 },
                    onEachFeature: function (feature, layer) {
                        layer.bindPopup("<b>Saluran Mikro:</b> " + (feature.properties.toponimi || "Tanpa Nama"));
                    }
                }).addTo(map);
            })
            .catch(err => console.error("Gagal load file mikro:", err));

    </script>
</body>
</html>
