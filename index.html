<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebGIS Saluran PHB Tersier</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        body { margin: 0; padding: 0; }
        #map { width: 100%; height: 100vh; }
        
        /* Gaya untuk label judul di peta */
        .info-title {
            padding: 6px 8px;
            font: 14px/16px Arial, Helvetica, sans-serif;
            background: white;
            background: rgba(255,255,255,0.8);
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            border-radius: 5px;
            line-height: 24px;
            color: #333;
        }
    </style>
</head>
<body>

    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script src="data_saluranphb.js"></script>

    <script>
        // 1. Inisialisasi Peta (Koordinat Jakarta)
        var map = L.map('map').setView([-6.2088, 106.8456], 13);

        // 2. Tambahkan Layer Peta (Basemap) dari OpenStreetMap
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: 'Â© OpenStreetMap contributors'
        }).addTo(map);

        // 3. Fungsi untuk menampilkan Popup saat fitur diklik
        function onEachFeature(feature, layer) {
            if (feature.properties) {
                var content = "<table border='1' style='border-collapse: collapse; width: 100%;'>" +
                    "<tr><th>Nama</th><td>" + (feature.properties.toponimi || "-") + "</td></tr>" +
                    "<tr><th>Kecamatan</th><td>" + (feature.properties.kecamatan || "-") + "</td></tr>" +
                    "<tr><th>Panjang (m)</th><td>" + (feature.properties.panjang || "-") + "</td></tr>" +
                    "<tr><th>Lebar (m)</th><td>" + (feature.properties.lebar || "-") + "</td></tr>" +
                    "<tr><th>Kedalaman (m)</th><td>" + (feature.properties.kedalaman || "-") + "</td></tr>" +
                    "</table>";
                layer.bindPopup(content);
            }
            
            // Mengubah warna saat mouse lewat (hover)
            layer.on({
                mouseover: function(e) {
                    var layer = e.target;
                    layer.setStyle({
                        weight: 5,
                        color: '#ff0000',
                        dashArray: ''
                    });
                },
                mouseout: function(e) {
                    geojsonLayer.resetStyle(e.target);
                }
            });
        }

        // 4. Memasukkan data GeoJSON ke peta
        // Pastikan variabel di bawah ini (dataSaluranPHB) sama dengan nama variabel di file .js Anda
        var geojsonLayer;
        
        if (typeof dataSaluranPHB !== 'undefined') {
            geojsonLayer = L.geoJSON(dataSaluranPHB, {
                style: function(feature) {
                    return {
                        color: "#007bff", // Warna biru untuk saluran
                        weight: 3,
                        opacity: 0.8
                    };
                },
                onEachFeature: onEachFeature
            }).addTo(map);

            // Zoom peta otomatis ke lokasi data
            map.fitBounds(geojsonLayer.getBounds());
        } else {
            alert("Gagal memuat data! Periksa apakah nama variabel di data_saluranphb.js sudah benar.");
        }

        // 5. Tambahkan Judul di pojok kanan atas
        var title = L.control();
        title.onAdd = function (map) {
            this._div = L.DomUtil.create('div', 'info-title');
            this._div.innerHTML = '<h4>Peta Saluran PHB Tersier</h4>';
            return this._div;
        };
        title.addTo(map);

    </script>
</body>
</html>
